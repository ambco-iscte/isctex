\ProvidesPackage{proposal}

\RequirePackage[T1]{fontenc}
\RequirePackage{lmodern}
\RequirePackage[defaultfam]{montserrat}
\renewcommand*\oldstylenums[1]{{\fontfamily{Montserrat-TOsF}\selectfont #1}}

\RequirePackage{geometry}
 \geometry{
 a4paper,
 left=20mm,
 right=20mm,
 bottom=50mm,
 top=25mm,
 }
 
\RequirePackage{graphicx} 
\RequirePackage{fancyhdr}\renewcommand{\headrulewidth}{0pt}
\RequirePackage{amssymb}
\RequirePackage[most]{tcolorbox}
\RequirePackage{afterpage}

\RequirePackage{minted}
\tcbuselibrary{minted}

\RequirePackage{eurosym}
\RequirePackage{amsmath}
\RequirePackage{amsfonts}
\RequirePackage[onehalfspacing]{setspace}
\RequirePackage{chngcntr}
\RequirePackage[english]{babel}
\RequirePackage{fancyhdr}
\RequirePackage{titlesec}
\RequirePackage{enumitem}
\RequirePackage{etoolbox}
\RequirePackage[printonlyused]{acronym}

\RequirePackage[
    backend=biber,
    style=ieee,
    mincitenames=1,
    maxcitenames=3, 
    minbibnames=3,
    maxbibnames=99,
    uniquename=false,
    uniquelist=false
]{biblatex}

\RequirePackage{caption}
\RequirePackage{subcaption}
\RequirePackage{listings}
\RequirePackage{booktabs}
\RequirePackage{microtype} 
\RequirePackage{xcolor}
\RequirePackage{url}
\RequirePackage{tipa}
\RequirePackage{bigfoot}
\RequirePackage{minted}
\RequirePackage{algorithm}
\RequirePackage{algorithmicx}
\RequirePackage{algpseudocode}
\RequirePackage{csquotes}
\RequirePackage[hidelinks]{hyperref}
\RequirePackage{environ}
\RequirePackage{xstring}
\RequirePackage[bottom, flushmargin]{footmisc}
\RequirePackage[useregional]{datetime2}

\setlength{\headsep}{1in}

\newcommand\blankpage{%
    \pagebreak
    \null
    \thispagestyle{empty}%
    \addtocounter{page}{-1}%
    \newpage}

\let\olddocument=\document
\let\oldenddocument=\enddocument

\renewcommand{\title}[1]{\gdef\thetitle{#1}}

% SUPERVISORS
% ========================================================
\newcounter{numsupervisors}
\newcommand{\supervisor}[2]{
    \stepcounter{numsupervisors}
    \ifnum\value{numsupervisors}>3
        \PackageError{Project Proposal}{You're trying to provide \arabic{numsupervisors} supervisors, which is not allowed. Your project can only have up to three supervisors: two from ISCTE-IUL, and one from another institution}{}
    \else
        \ifdef\thesupervisors{
            \edef\thesupervisors{
                \thesupervisors{}~\\\centerline{#1,}\\\centerline{#2}
            }
        }{ % else
            \gdef\thesupervisors{\centerline{#1,}\centerline{#2}}
        }
    \fi
}
% ========================================================

\newcommand{\candidate}[1]{\gdef\thecandidate{#1}}

\newcommand{\program}[1]{\gdef\theprogram{#1}}

\setlength{\headheight}{33.52266pt}

\renewenvironment{document}{\olddocument
\pagestyle{fancy}
\fancyhead{}
\fancyhead[C]{
    \includegraphics[width=0.4\linewidth]{images/ista.png}
}
\begin{center}

\vspace*{35pt}

\noindent{\fontseries{extrabold}\selectfont\Large Research Project Proposal and Project Execution Plan} 

\large

\vspace{5pt}\hfill

\noindent\theprogram

\vspace{50pt}\hfill

\noindent{\fontseries{bold}\selectfont\thetitle}

\vspace{50pt}\hfill

\ifnum\value{numsupervisors}=1
    \noindent{\fontseries{bold}\selectfont\textsc{Supervisor}}
\else
    \ifnum\value{numsupervisors}<1
        \PackageError{Project Proposal}{Your project must have at least one supervisor, but you did not provide any}{}
    \else
        \ifnum\value{numsupervisors}>3
            \PackageError{Project Proposal}{You're trying to provide \arabic{numsupervisors} supervisors, which is not allowed. Your project can only have up to three supervisors: two from ISCTE-IUL, and one from another institution}{}
        \else
            \noindent{\fontseries{bold}\selectfont\textsc{Supervisors}}
        \fi
    \fi
\fi

{\fontseries{regular}\selectfont\thesupervisors}

\vspace{50pt}\hfill

\noindent{\fontseries{bold}\selectfont\textsc{Candidate}}

\noindent{\fontseries{regular}\selectfont\thecandidate}

\vspace{\fill}

\noindent{\fontseries{regular}\selectfont Lisbon, \today}

\end{center}
\pagenumbering{gobble}

\pagebreak

\pagenumbering{arabic}
\fancyfoot[c]{\fontseries{regular}\selectfont\thepage}

}{
\pagebreak
\printbibliography[title={References}]
\oldenddocument
}