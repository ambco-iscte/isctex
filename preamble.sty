\ProvidesPackage{preamble}

% =================================================================
% Hey! Don't mess with this file unless you know what you're doing!
% =================================================================

\usepackage{eurosym}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage[onehalfspacing]{setspace}
\usepackage{chngcntr}
\usepackage{graphicx}
\usepackage[a4paper, margin=2.5cm]{geometry}
\usepackage[english]{babel}
\usepackage{fancyhdr}
\usepackage{titlesec}
\usepackage{enumitem}
\usepackage{etoolbox}
\usepackage[printonlyused]{acronym}
\usepackage{cite}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{listings}
\usepackage{booktabs}
\usepackage{microtype} 
\usepackage{xcolor}
\usepackage{url}
\usepackage{tipa}
\usepackage{bigfoot}
\usepackage{minted}
\usepackage{algorithm}
\usepackage{algorithmicx}
\usepackage{algpseudocode}
\usepackage{csquotes}
\RequirePackage{hyperref}
\hypersetup{
    colorlinks=true,
    citecolor=black,
    linkcolor=black,
    filecolor=black,      
    urlcolor=black,
}
%
% you may need to uncomment the command below if you use eps format for figures
%\usepackage{epstopdf}
%

\lstdefinestyle{prettycode}{
    backgroundcolor=\color{gray!3!white},
    commentstyle={\color{darkgray!90!white}\ttfamily},
    %commentstyle=\color{codegreen},
    %keywordstyle=\color{magenta},
    %numberstyle=\tiny\color{codegray},
    %stringstyle=\color{codepurple},
    frame=single,
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    %numbers=left,                    
    %numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}
\lstset{style=prettycode}

\titleformat{\subsubsection}{\normalfont\normalsize\bfseries}{\thesubsubsection}{0.5em}{}
\titlespacing*{\subsubsection}
{0pt}{2.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

%
\makeatletter
    \def\section{\@startsection{section}{1}%
      \z@{.5\linespacing\@plus.7\linespacing}{.25\linespacing}%
      {\normalfont\bfseries\flushleft}}
      
    \def\subsection{\@startsection{subsection}{2}%
      \z@{.5\linespacing\@plus.7\linespacing}{.25\linespacing}%
      {\normalfont\bfseries\flushleft}}

    \def\subsubsection{\@startsection{subsubsection}{3}%
      \z@{.5\linespacing\@plus.7\linespacing}{.1\linespacing}%
      {\normalfont\itshape}}

    \let\@afterindenttrue\@afterindentfalse
\makeatother

\setcounter{MaxMatrixCols}{10}
%
\providecommand{\U}[1]{\protect\rule{.1in}{.1in}}
\theoremstyle{plain}
\newtheorem{acknowledgement}{Acknowledgement}
\newtheorem{axiom}{Axiom}[chapter]
\newtheorem{case}{Case}[chapter]
\newtheorem{claim}{Claim}[chapter]
\newtheorem{conclusion}{Conclusion}[chapter]
\newtheorem{condition}{Condition}[chapter]
\newtheorem{conjecture}{Conjecture}[chapter]
\newtheorem{corollary}{Corollary}[chapter]
\newtheorem{criterion}{Criterion}[chapter]
\newtheorem{definition}{Definition}[chapter]
\newtheorem{example}{Example}[chapter]
\newtheorem{exercise}{Exercise}[chapter]
\newtheorem{lemma}{Lemma}[chapter]
\newtheorem{notation}{Notation}[chapter]
\newtheorem{problem}{Problem}[chapter]
\newtheorem{proposition}{Proposition}[chapter]
\newtheorem{remark}{Remark}[chapter]
\newtheorem{solution}{Solution}[chapter]
\newtheorem{summary}{Summary}[chapter]
\newtheorem{theorem}{Theorem}[chapter]
\numberwithin{equation}{chapter}
%
\makeatletter
\newcommand\frontFont{\@setfontsize\frontFont{14.4}{14.4}}
\newcommand\numberprefix{}
\def\numberline#1{\hb@xt@\@tempdima{\numberprefix #1\hfil}}

% ============================================================
\newcommand{\lofskip}[1]{\gdef\listOfFiguresLeftSpacing{#1}}
\newcommand{\lotskip}[1]{\gdef\listOfTablesLeftSpacing{#1}}
% ============================================================

% List of Figures
\def\l@figure#1#2{\@tocline{0}{3pt plus2pt}{0pt}{\ifdef\listOfFiguresLeftSpacing{\listOfFiguresLeftSpacing}{6pc}}{}%
  {\renewcommand\numberprefix{Figure~}#1}{#2}}

% List of Tables
\def\l@table#1#2{\@tocline{0}{3pt plus2pt}{0pt}{\ifdef\listOfTablesLeftSpacing{\listOfTablesLeftSpacing}{6pc}}{}%
  {\renewcommand\numberprefix{Table~}#1}{#2}}
\makeatother

\makeatletter
\def\cleardoublepage{\clearpage\if@twoside%
  \ifodd\c@page\else
  \vspace*{\fill}
  \hfill
  \begin{center}
  {\fontfamily{Montserrat-TOsF}\selectfont\small [ This page is intentionally left blank. ]}
  
  \end{center}
  \vspace{\fill}
  \thispagestyle{empty}
  \newpage
 \if@twocolumn\hbox{}\newpage\fi\fi\fi
}
\makeatother

%
% Please write the references according to your school
%
\newenvironment{dedicationenv}
  {%\clearpage           % we want a new page
   \thispagestyle{empty}% no header and footer
   \vspace*{\stretch{1}}% some space at the top
   %\itshape             % the text is in italics
   \raggedleft          % flush to the right margin
  }
  {\par % end the paragraph
   \vspace{\stretch{3}} % space at bottom is three times that at the top
   %\clearpage           % finish off the page
  }
  \numberwithin{section}{chapter}
\fancyhf{}
\pagestyle{fancy}
\fancyfoot[LE,RO]{\scriptsize\thepage}
%
\makeatletter
\def\ps@plain{\ps@empty
 \def\@evenfoot{%
   \normalfont\scriptsize
   \rlap{\thepage}\hfil
   }%
 \def\@oddfoot{%
   \normalfont\scriptsize\hfil
   \llap{\thepage}
   }%
}
\makeatother
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
%
\usepackage{montserrat}
\usepackage[T1]{fontenc}
\renewcommand*\oldstylenums[1]{{\fontfamily{Montserrat-TOsF}\selectfont #1}}
%
\numberwithin{table}{chapter}
\numberwithin{figure}{chapter}

\setlength{\parindent}{0.7cm}

\addto{\extrasenglish}{%
  \renewcommand{\bibname}{References}
}

\let\olddocument=\document
\let\oldenddocument=\enddocument

\makeatletter
\def\l@subsection{\@tocline{2}{0pt}{2.5pc}{5pc}{}}
\makeatother

% =================================================================
\renewcommand{\title}[1]{\gdef\thetitle{#1}}

\renewcommand{\date}[2]{\gdef\thedate{#1, #2}}

\renewcommand{\author}[1]{\gdef\theauthor{#1}}

\newcommand{\department}[1]{\gdef\thedepartment{#1}}

\newcommand{\program}[1]{\gdef\theprogram{#1}}

\newcommand{\supervisor}[4]{
    \gdef\thesupervisor{#1 #2, #3}
    \gdef\thesupervisoraffiliation{#4}
}

\newcommand{\cosupervisor}[4]{
    \gdef\thecosupervisor{#1 #2, #3}
    \gdef\thecosupervisoraffiliation{#4}
}

\newcommand{\acknowledgements}[1]{\gdef\theacknowledgements{#1}}

\newcommand{\dedication}[1]{\gdef\thededication{#1}}

\newcommand{\resumo}[2]{
    \gdef\theabstractpt{#1}
    \gdef\thekeywordspt{#2}
}

\renewcommand{\abstract}[2]{
    \gdef\theabstract{#1}
    \gdef\thekeywords{#2}
}

\newcommand{\acronyms}[1]{\gdef\theacronyms{#1}}
% =================================================================

\definecolor{ISCTEDarkBlue}{rgb}{0,0.08,0.45}

\renewenvironment{document}{\olddocument

\sffamily
\frontFont
\begin{flushleft}
\includegraphics[width=6.03cm]{images/iscte.png}\\[3.3mm]

{\color{ISCTEDarkBlue}\hrulefill}
~\\
~\\
~\\
\textbf{\thetitle}\\
~\\
~\\
~\\
~\\
\theauthor\\
~\\
~\\
~\\
~\\
\theprogram\\
~\\
~\\
~\\
\ifdef\thecosupervisor
{
    Supervisor:
    ~\\
    \thesupervisor,\\
    \thesupervisoraffiliation
    ~\\
    ~\\
    Co-Supervisor:
    ~\\
    \thecosupervisor,\\
    \thecosupervisoraffiliation
}
{
    Supervisor:
    ~\\
    \thesupervisor,\\
    \thesupervisoraffiliation
}
~\\
~\\
~\\
~\\
\thedate
\end{flushleft}
\thispagestyle{empty}
\cleardoublepage
\begin{flushleft}
  \includegraphics[width=6.03cm]{images/ista.png}\\[7mm]

{\color{ISCTEDarkBlue}\hrulefill}
~\\
~\\
~\\
\thedepartment
~\\
~\\
~\\
~\\
\textbf{\thetitle}\\
~\\
~\\
~\\
~\\
\theauthor\\
~\\
~\\
~\\
~\\
\theprogram\\
~\\
~\\
~\\
\ifdef\thecosupervisor
{
    Supervisor:
    ~\\
    \thesupervisor,\\
    \thesupervisoraffiliation
    ~\\
    ~\\
    Co-Supervisor:
    ~\\
    \thecosupervisor,\\
    \thecosupervisoraffiliation
}
{
    Supervisor:
    ~\\
    \thesupervisor,\\
    \thesupervisoraffiliation
}
~\\
~\\
~\\
~\\
\thedate
\end{flushleft}
\thispagestyle{empty}
\rmfamily
\normalsize
\frontmatter
%\addtocontents{toc}{\setcounter{tocdepth}{2}}
\thispagestyle{empty}

\frontmatter
\addtocontents{toc}{\setcounter{tocdepth}{2}}
\thispagestyle{empty}

\ifdef\thededication
{
    \begin{dedicationenv}%
    \begin{flushright}
    \thededication
    \end{flushright}%
    \end{dedicationenv}
}

\setcounter{page}{1}
\pagenumbering{roman} %
\ifdef\theacknowledgements
{
    \chapter*{Acknowledgments}
    \theacknowledgements
}

\chapter*{Resumo}
\theabstractpt

\vspace{3ex}
\noindent\textbf{Palavras-Chave:} \textit{\thekeywordspt}

\chapter*{Abstract}
\theabstract

\vspace{3ex}
\noindent\textbf{Keywords:} \textit{\thekeywords}

\tableofcontents
\listoffigures
\listoftables
\cleardoublepage
%\printglossary[type=\acronymtype, nonumberlist, nogroupskip]
\ifdef\theacronyms
{
    \chapter*{List of Acronyms}
    \begin{acronym}
    \theacronyms
    \end{acronym}
}

\mainmatter

\hyphenation{wri-te he-re pro-per hy-phe-ni-za-tion
}%

\setcounter{page}{1}
\pagenumbering{arabic}
}{
\bibliographystyle{plain}
\bibliography{references}{}
\oldenddocument
}